# 焼きなまし関連のTips

- 実行時間を延ばして伸びしろを確認する。(極端に伸ばすこと。例えば100秒など。)
  - 伸ばしてスコアが伸びる
    - ボトルネックになっている部分を探す
      - 実測して確認する
    - 高速化
      - 定数倍高速化
        - vectorの1次元化
        - vectorよりarrayのほうがわずかに早い？
        - debug出力の削除
        - 前計算(validな4方向への移動など)
      - 差分評価
      - フルスコアを計算する場合には一定間隔でスナップショットを取る。
        - 例えば前から計算する場合、途中から計算すれば良くなる
      - 状態変更 -> スコア計算 -> 棄却ならば戻すだと遅いので、状態を変更した場合を想定してスコア計算を可能にする
      - 遅い計算の前計算(sin, cos, tan, exp, log, pow, sqrt)
      - 更新回数は(基本的に)少ない
        - 複雑な状態を前計算 & 更新してもボトルネックになり辛い
    - 受理率の高い近傍を選ばれやすくする(重みづけをする)
    - 正規分布から選ぶなど
    - スコアのネックとなっている個所(改善幅が大きい場所)を選ばれやすくする
    - 複数の近傍に対して貪欲に選ぶ
    - g++, clangの切り替え
      - g++ならコンパイルオプションでだいぶ伸びたりする
    - オンラインジャッジ上の速度を確認する
  - 伸びない
    - 破壊再構築(良い貪欲があるなら強い。山登り向け？)
    - 近傍の追加
    - 早い段階で収束しており、温度を上げても改善しない
      - 山登りが強いかも
      - 多点スタート
    - 初期解を頑張る
- 序盤は大きく変化、終盤になるほど変化の量を小さくする
- 貪欲が非自明なものを焼いて固定し、自明な部分を貪欲で解く